syntax = "proto3";
package hyperlane.core.interchain_security.v1;

option go_package = "github.com/bcp-innovations/hyperlane-cosmos/x/core/01_interchain_security/types";

import "cosmos_proto/cosmos.proto";
import "cosmos/msg/v1/msg.proto";
import "amino/amino.proto";
import "hyperlane/core/interchain_security/v1/types.proto";
import "gogoproto/gogo.proto";

// Msg defines the module Msg service.
service Msg {
  option (cosmos.msg.v1.service) = true;

  // CreateMessageIdMultisigIsm ...
  rpc CreateMessageIdMultisigIsm(MsgCreateMessageIdMultisigIsm)
      returns (MsgCreateMessageIdMultisigIsmResponse);

  // CreateMerkleRootMultisigIsm ...
  rpc CreateMerkleRootMultisigIsm(MsgCreateMerkleRootMultisigIsm)
      returns (MsgCreateMerkleRootMultisigIsmResponse);

  // CreateNoopIsm ...
  rpc CreateNoopIsm(MsgCreateNoopIsm) returns (MsgCreateNoopIsmResponse);

  // CreateRoutingIsm ...
  rpc CreateRoutingIsm(MsgCreateRoutingIsm)
      returns (MsgCreateRoutingIsmResponse);

  // SetRoutingIsmDomain ...
  rpc SetRoutingIsmDomain(MsgSetRoutingIsmDomain)
      returns (MsgSetRoutingIsmDomainResponse);

  // RemoveRoutingIsmDomain ...
  rpc RemoveRoutingIsmDomain(MsgRemoveRoutingIsmDomain)
      returns (MsgRemoveRoutingIsmDomainResponse);

  // UpdateRoutingIsmOwner ...
  rpc UpdateRoutingIsmOwner(MsgUpdateRoutingIsmOwner)
      returns (MsgUpdateRoutingIsmOwnerResponse);

  // AnnounceValidator ...
  rpc AnnounceValidator(MsgAnnounceValidator)
      returns (MsgAnnounceValidatorResponse);

  // CreateAggregationIsm creates a new Aggregation ISM that requires a threshold
  // of child ISMs to pass verification. The creator becomes the owner of the ISM.
  // Emits EventCreateAggregationIsm on success.
  rpc CreateAggregationIsm(MsgCreateAggregationIsm)
      returns (MsgCreateAggregationIsmResponse);

  // SetAggregationIsmModules updates the modules and threshold of an existing
  // Aggregation ISM. Only the owner can perform this operation.
  // Emits EventSetAggregationIsmModules on success.
  rpc SetAggregationIsmModules(MsgSetAggregationIsmModules)
      returns (MsgSetAggregationIsmModulesResponse);

  // UpdateAggregationIsmOwner transfers ownership of an Aggregation ISM to a new
  // address or renounces ownership entirely. Only the current owner can perform
  // this operation. Emits EventSetAggregationIsm on success.
  rpc UpdateAggregationIsmOwner(MsgUpdateAggregationIsmOwner)
      returns (MsgUpdateAggregationIsmOwnerResponse);
}

// MsgCreateMessageIdMultisigIsm ...
message MsgCreateMessageIdMultisigIsm {
  option (cosmos.msg.v1.signer) = "creator";
  option (amino.name) = "hyperlane/v1/MsgCreateMessageIdMultisigIsm";

  // creator is the message sender.
  string creator = 1;

  // validators
  // these are 20 byte long ethereum style addresses
  repeated string validators = 2;

  // threshold ...
  uint32 threshold = 3;
}

// MsgCreateMessageIdMultisigIsmResponse ...
message MsgCreateMessageIdMultisigIsmResponse {
  string id = 1 [
    (gogoproto.customtype) =
        "github.com/bcp-innovations/hyperlane-cosmos/util.HexAddress",
    (gogoproto.nullable) = false
  ];
}

// MsgCreateMerkleRootMultisigIsm ...
message MsgCreateMerkleRootMultisigIsm {
  option (cosmos.msg.v1.signer) = "creator";
  option (amino.name) = "hyperlane/v1/MsgCreateMerkleRootMultisigIsm";

  // creator is the message sender.
  string creator = 1;

  // validators
  // these are 20 byte long ethereum style addresses
  repeated string validators = 2;

  // threshold ...
  uint32 threshold = 3;
}

// MsgCreateMerkleRootMultisigIsmResponse ...
message MsgCreateMerkleRootMultisigIsmResponse {
  string id = 1 [
    (gogoproto.customtype) =
        "github.com/bcp-innovations/hyperlane-cosmos/util.HexAddress",
    (gogoproto.nullable) = false
  ];
}

// MsgCreateNoopIsm ...
message MsgCreateNoopIsm {
  option (cosmos.msg.v1.signer) = "creator";
  option (amino.name) = "hyperlane/v1/MsgCreateNoopIsm";

  // creator is the message sender.
  string creator = 1;
}

// MsgCreateNoopIsmResponse ...
message MsgCreateNoopIsmResponse {
  string id = 1 [
    (gogoproto.customtype) =
        "github.com/bcp-innovations/hyperlane-cosmos/util.HexAddress",
    (gogoproto.nullable) = false
  ];
}

// MsgAnnounceValidator ...
message MsgAnnounceValidator {
  option (cosmos.msg.v1.signer) = "creator";
  option (amino.name) = "hyperlane/v1/MsgAnnounceValidator";

  // validator ...
  string validator = 1;

  // storage_location ...
  string storage_location = 2;

  // signature ...
  string signature = 3;

  // mailbox_id ...
  string mailbox_id = 4 [
    (gogoproto.customtype) =
        "github.com/bcp-innovations/hyperlane-cosmos/util.HexAddress",
    (gogoproto.nullable) = false
  ];

  // creator ...
  string creator = 5;
}

// MsgAnnounceValidatorResponse ...
message MsgAnnounceValidatorResponse {}

// MsgCreateRoutingIsm ...
message MsgCreateRoutingIsm {
  option (cosmos.msg.v1.signer) = "creator";
  option (amino.name) = "hyperlane/v1/MsgCreateRoutingIsm";

  // creator ...
  string creator = 1;

  // routes ...
  repeated Route routes = 2 [ (gogoproto.nullable) = false ];
}

// MsgCreateRoutingIsmResponse ...
message MsgCreateRoutingIsmResponse {
  string id = 1 [
    (gogoproto.customtype) =
        "github.com/bcp-innovations/hyperlane-cosmos/util.HexAddress",
    (gogoproto.nullable) = false
  ];
}

// MsgSetRoutingIsmDomain ...
message MsgSetRoutingIsmDomain {
  option (cosmos.msg.v1.signer) = "owner";
  option (amino.name) = "hyperlane/v1/MsgSetRoutingIsmDomain";

  // ism_id ...
  string ism_id = 1 [
    (gogoproto.customtype) =
        "github.com/bcp-innovations/hyperlane-cosmos/util.HexAddress",
    (gogoproto.nullable) = false
  ];

  // route ...
  Route route = 2 [ (gogoproto.nullable) = false ];

  // owner ...
  string owner = 3;
}

// MsgSetRoutingIsmDomainResponse ...
message MsgSetRoutingIsmDomainResponse {}

// MsgRemoveRoutingIsmDomain ...
message MsgRemoveRoutingIsmDomain {
  option (cosmos.msg.v1.signer) = "owner";
  option (amino.name) = "hyperlane/v1/MsgRemoveRoutingIsmDomain";

  // ism_id ...
  string ism_id = 1 [
    (gogoproto.customtype) =
        "github.com/bcp-innovations/hyperlane-cosmos/util.HexAddress",
    (gogoproto.nullable) = false
  ];

  // domain ...
  uint32 domain = 2;

  // owner ...
  string owner = 3;
}

// MsgRemoveRoutingIsmDomainResponse ...
message MsgRemoveRoutingIsmDomainResponse {}

// MsgUpdateRoutingIsmOwner ...
message MsgUpdateRoutingIsmOwner {
  option (cosmos.msg.v1.signer) = "owner";
  option (amino.name) = "hyperlane/v1/MsgUpdateRoutingIsmOwner";

  // ism_id ...
  string ism_id = 1 [
    (gogoproto.customtype) =
        "github.com/bcp-innovations/hyperlane-cosmos/util.HexAddress",
    (gogoproto.nullable) = false
  ];

  // owner ...
  string owner = 2;

  // new owner
  string new_owner = 3 [ (cosmos_proto.scalar) = "cosmos.AddressString" ];

  // renounce_ownership
  bool renounce_ownership = 4;
}

// MsgUpdateRoutingIsmOwnerResponse ...
message MsgUpdateRoutingIsmOwnerResponse {}

// MsgCreateAggregationIsm creates an Aggregation ISM that verifies messages by
// requiring a threshold number of child ISMs to pass verification (M-of-N pattern).
message MsgCreateAggregationIsm {
  option (cosmos.msg.v1.signer) = "creator";
  option (amino.name) = "hyperlane/v1/MsgCreateAggregationIsm";

  // creator is the address that will become the owner of the ISM
  string creator = 1 [ (cosmos_proto.scalar) = "cosmos.AddressString" ];

  // modules is the list of child ISM IDs to aggregate
  repeated string modules = 2 [
    (gogoproto.customtype) =
        "github.com/bcp-innovations/hyperlane-cosmos/util.HexAddress",
    (gogoproto.nullable) = false
  ];

  // threshold is the number of child ISMs that must pass (must be > 0 and <= len(modules))
  uint32 threshold = 3;
}

// MsgCreateAggregationIsmResponse returns the ID of the newly created Aggregation ISM
message MsgCreateAggregationIsmResponse {
  // id is the unique identifier of the created Aggregation ISM
  string id = 1 [
    (gogoproto.customtype) =
        "github.com/bcp-innovations/hyperlane-cosmos/util.HexAddress",
    (gogoproto.nullable) = false
  ];
}

// MsgSetAggregationIsmModules updates the child ISMs and threshold of an existing
// Aggregation ISM. Only the current owner can execute this operation.
message MsgSetAggregationIsmModules {
  option (cosmos.msg.v1.signer) = "owner";
  option (amino.name) = "hyperlane/v1/MsgSetAggregationIsmModules";

  // ism_id is the identifier of the Aggregation ISM to update
  string ism_id = 1 [
    (gogoproto.customtype) =
        "github.com/bcp-innovations/hyperlane-cosmos/util.HexAddress",
    (gogoproto.nullable) = false
  ];

  // modules is the new list of child ISM IDs to aggregate
  repeated string modules = 2 [
    (gogoproto.customtype) =
        "github.com/bcp-innovations/hyperlane-cosmos/util.HexAddress",
    (gogoproto.nullable) = false
  ];

  // threshold is the new number of child ISMs that must pass verification
  uint32 threshold = 3;

  // owner is the current owner address (must match the ISM's owner)
  string owner = 4 [ (cosmos_proto.scalar) = "cosmos.AddressString" ];
}

// MsgSetAggregationIsmModulesResponse ...
message MsgSetAggregationIsmModulesResponse {}

// MsgUpdateAggregationIsmOwner transfers ownership of an Aggregation ISM to a new
// address or renounces ownership entirely. Only the current owner can execute this.
message MsgUpdateAggregationIsmOwner {
  option (cosmos.msg.v1.signer) = "owner";
  option (amino.name) = "hyperlane/v1/MsgUpdateAggregationIsmOwner";

  // ism_id is the identifier of the Aggregation ISM
  string ism_id = 1 [
    (gogoproto.customtype) =
        "github.com/bcp-innovations/hyperlane-cosmos/util.HexAddress",
    (gogoproto.nullable) = false
  ];

  // owner is the current owner address (must match the ISM's owner)
  string owner = 2 [ (cosmos_proto.scalar) = "cosmos.AddressString" ];

  // new_owner is the address to transfer ownership to (ignored if renounce_ownership is true)
  string new_owner = 3 [ (cosmos_proto.scalar) = "cosmos.AddressString" ];

  // renounce_ownership removes ownership permanently if true (new_owner must be empty)
  bool renounce_ownership = 4;
}

// MsgUpdateAggregationIsmOwnerResponse ...
message MsgUpdateAggregationIsmOwnerResponse {}